<div class="card h-100 shadow-sm" (click)="viewRecipe()" style="cursor: pointer;">
  @if (recipe.image) {
    <img [src]="recipe.image" class="card-img-top" [alt]="recipe.title" style="height: 150px; object-fit: cover;">
  } @else {
    <div class="card-img-top bg-secondary d-flex align-items-center justify-content-center" style="height: 150px;">
      <i class="bi bi-image text-white" style="font-size: 3rem;"></i>
    </div>
  }
  
  <div class="card-body">
    <h5 class="card-title">{{ recipe.title }}</h5>
    
    @if (recipe.level) {
      <div class="mb-3">
        <span class="badge" [ngClass]="getLevelClass(recipe.level)">
          {{ getLevelText(recipe.level) }}
        </span>
      </div>
    }
    
    @if (recipe.time) {
      <div class="d-flex align-items-center text-muted">
        <i class="bi bi-clock me-1"></i>
        <small>{{ recipe.time }} minut</small>
      </div>
    }

    <div class="mt-auto d-flex justify-content-between align-items-end">
      <div></div>
      <div class="dropdown" (click)="$event.stopPropagation()" style="position: relative;">
        <button 
          class="btn btn-link text-muted p-0" 
          (click)="toggleMenu($event)"
          style="border: none; background: none;"
          aria-label="Možnosti recepta">
          <i class="bi bi-three-dots-vertical" style="font-size: 1.2rem;"></i>
        </button>
        
        @if (showMenu && !showDeleteConfirm) {
          <div class="dropdown-menu show" style="display: block; position: absolute; right: 0; top: 100%; z-index: 1000;">
            <button class="dropdown-item" (click)="editRecipe($event)">
              <i class="bi bi-pencil me-2"></i> Uredi
            </button>
            <div class="dropdown-divider"></div>
            <button class="dropdown-item text-danger" (click)="deleteRecipe($event)">
              <i class="bi bi-trash me-2"></i> Izbriši
            </button>
          </div>
        }
        
        @if (showDeleteConfirm) {
          <div class="dropdown-menu show" style="display: block; position: absolute; right: 0; top: 100%; z-index: 1000; width: 250px;">
            <div class="p-3">
              <h6 class="mb-2">
                <i class="bi bi-exclamation-triangle text-warning me-2"></i>
                Potrdi brisanje
              </h6>
              <p class="small text-muted mb-3">
                Ali ste prepričani, da želite izbrisati recept "{{ recipe.title }}"?
                Tega dejanja ni mogoče razveljaviti.
              </p>
              <div class="d-flex justify-content-between">
                <button class="btn btn-sm btn-outline-secondary" (click)="cancelDelete($event)">
                  Prekliči
                </button>
                <button class="btn btn-sm btn-danger" (click)="confirmDelete($event)">
                  <i class="bi bi-trash me-1"></i> Izbriši
                </button>
              </div>
            </div>
          </div>
        }
      </div>
    </div>
  </div>
</div>